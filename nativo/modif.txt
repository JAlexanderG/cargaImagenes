Function AddSignDesdeArchivo(codigo As String, id As String, rutaImagen As String) As String
    Dim Pos As Long
    Dim PosActual As Long
    Dim SignData As String
    Dim CampoData As String
    Dim chunk() As Byte
    Dim lngOffset As Long
    Dim lngChunkSize As Long
    Dim SqlStr As String
    Dim rs_firma As New ADODB.Recordset
    Dim fileNum As Integer
    Dim fileSize As Long

    On Error GoTo Err_AddSign

    If Conn Is Nothing Or Conn.State = adStateClosed Then
        AbrirConexion
    End If

    ' ðŸ”¥ LEER LA IMAGEN DESDE EL ARCHIVO
    fileNum = FreeFile()
    Open rutaImagen For Binary As #fileNum
    fileSize = LOF(fileNum) ' Obtener el tamaÃ±o del archivo
    ReDim chunk(fileSize - 1) ' Reservar espacio en memoria
    Get #fileNum, 1, chunk ' Leer el archivo en la variable chunk
    Close #fileNum

    ' ðŸ”¥ INSERTAR EN LA BASE DE DATOS
    SqlStr = "SELECT * FROM IMAGENES WHERE CODIGO = '" & codigo & "' AND ID = '" & id & "'"
    Set rs_firma = New ADODB.Recordset
    rs_firma.Open SqlStr, Conn, adOpenKeyset, adLockOptimistic

    If Not rs_firma.EOF Then
        rs_firma("largo") = fileSize
        lngOffset = 0
        Do While lngOffset < fileSize
            rs_firma("foto").AppendChunk LeftB(RightB(chunk, fileSize - lngOffset), conChunksize2)
            lngOffset = lngOffset + conChunksize2
        Loop

        rs_firma.Update
        AddSignDesdeArchivo = "OK"
    Else
        AddSignDesdeArchivo = "ERROR"
    End If

PROC_EXIT:
    If Not rs_firma Is Nothing Then
        rs_firma.Close
        Set rs_firma = Nothing
    End If
    Exit Function

Err_AddSign:
    AddSignDesdeArchivo = "ER"
    Resume PROC_EXIT
End Function